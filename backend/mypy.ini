[mypy]
# Mypy configuration for gradual type checking
# Created: December 2025 (P3-STYLE-2)

# Python version
python_version = 3.11

# Import discovery
mypy_path = backend
namespace_packages = True
explicit_package_bases = True

# Gradual typing settings (start permissive, tighten over time)
disallow_untyped_defs = False  # Don't require all functions to have type hints yet
disallow_untyped_calls = False  # Allow calling untyped functions
disallow_incomplete_defs = False  # Allow partially typed function signatures
check_untyped_defs = True  # Check function bodies even if signature is untyped

# Warnings (help catch issues)
warn_return_any = True  # Warn when returning Any from typed function
warn_unused_configs = True  # Warn about unused mypy config sections
warn_redundant_casts = True  # Warn about unnecessary casts
warn_unused_ignores = True  # Warn about unnecessary # type: ignore comments
warn_no_return = True  # Warn about missing return statements
warn_unreachable = True  # Warn about unreachable code

# Strictness settings (gradually enable these)
# strict_optional = True  # Already default
# strict_equality = True  # TODO: Enable in future
# disallow_any_generics = True  # TODO: Enable in future

# Third-party library handling
ignore_missing_imports = True  # Ignore imports that don't have type stubs
follow_imports = silent  # Don't analyze imported modules

# Error reporting
show_error_codes = True  # Show error codes (e.g., [arg-type])
show_column_numbers = True  # Show column numbers in errors
pretty = True  # Use color and formatting in output
error_summary = True  # Show summary of errors

# Caching
incremental = True  # Use incremental type checking (faster)
cache_dir = .mypy_cache

# Exclude patterns
exclude = (
    migrations/|
    deprecated/|
    __pycache__|
    \.pyc$|
    \.pyo$|
    \.venv/|
    venv/|
    env/
)

# Per-module settings (stricter for new, well-typed modules)
[mypy-repositories.base_repository]
disallow_untyped_defs = True
disallow_incomplete_defs = True

[mypy-services.base_service]
disallow_untyped_defs = True
disallow_incomplete_defs = True

# Ignore third-party packages without type stubs
[mypy-supabase.*]
ignore_missing_imports = True

[mypy-flask_wtf.*]
ignore_missing_imports = True

[mypy-flask_cors.*]
ignore_missing_imports = True

[mypy-google.generativeai.*]
ignore_missing_imports = True

[mypy-werkzeug.*]
ignore_missing_imports = True
