{
  "permissions": {
    "allow": [
      "Bash(git commit -m \"$(cat <<''EOF''\nAdd student-created tasks with AI quality analysis\n\nEnhances quest personalization wizard to allow students to write their own tasks with AI-powered quality feedback and auto-approval for high-quality submissions.\n\nKey features:\n- Path selection: Students choose between AI-generated or student-created tasks\n- AI quality analysis: Evaluates tasks on 4 criteria (specificity, present-focus, process-oriented, authenticity)\n- Auto-approval: Tasks scoring 70+ are instantly approved, eliminating admin bottleneck\n- Quality feedback: Detailed suggestions help students improve task design\n- XP determination: AI suggests appropriate XP values (50-200 range) based on complexity\n\nBackend changes:\n- TaskQualityService: New AI service for analyzing student task quality\n- Gemini prompt: Philosophy-aligned evaluation based on \"The Process Is The Goal\"\n- API endpoints: /analyze-manual-task and /add-manual-tasks for batch creation\n- Personalization service: Track creation_method (''ai'' or ''manual'') in sessions\n\nFrontend changes:\n- QualityScoreGauge: Circular gauge component with color-coded quality indicators\n- ManualTaskCreator: Full task creation interface with real-time AI feedback\n- QuestPersonalizationWizard: Added path selection step before interests\n\nQuality scoring criteria (0-25 pts each):\n1. Specificity: Clear, measurable actions vs vague goals\n2. Present-Focus: Celebrates discovery NOW (not future benefits)\n3. Process-Oriented: Values learning journey (mistakes welcome)\n4. Authenticity: Personal curiosity-driven (not rÃ©sumÃ©-building)\n\nApproval logic:\n- Score 70-100: Auto-approved immediately\n- Score 50-69: Student can revise or submit for admin review\n- Score <50: Must revise before submission\n\nAligns with core philosophy by empowering students to design their own learning while maintaining quality standards through AI guidance.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(git push:*)",
      "Bash(git checkout:*)",
      "Bash(git pull:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nImplement block-based evidence system for Spark webhook submissions (Option 1)\n\nUnifies evidence storage system to allow UI editing after webhook submission and eliminates schema mismatch between Spark webhooks and Optio evidence editor.\n\nProblem:\n- Spark webhook wrote to quest_task_completions.evidence_text (simple text)\n- UI evidence editor wrote to user_task_evidence_documents + evidence_document_blocks (rich blocks)\n- Evidence from webhooks couldn''t be edited in UI because it was in wrong table\n- UI saves appeared to work but didn''t persist for webhook-created evidence\n\nSolution (Option 1 - Full Block System):\nMake Spark webhook create block-based evidence like the UI editor, enabling seamless editing after webhook submission.\n\nImplementation:\n1. Created create_block_based_evidence() helper function\n   - Creates/updates user_task_evidence_documents record\n   - Handles existing documents from prior UI edits\n   - Clears old blocks when webhook provides new submission (Spark is authoritative)\n   - Creates evidence_document_blocks for all content\n\n2. Block type mapping based on content:\n   - submission_text â†’ text block with {text: \"...\"}\n   - image files â†’ image block with {url, alt, caption}\n   - video files â†’ video block with {url, title, platform: \"custom\"}\n   - document files (PDFs, docs) â†’ document block with {url, title, filename}\n\n3. Maintains backward compatibility:\n   - Still writes to quest_task_completions.evidence_text (legacy)\n   - Still writes to quest_task_completions.evidence_url (legacy)\n   - New block system works alongside for UI editing\n\nBenefits:\n- Evidence from Spark webhooks is now editable in Optio UI\n- Students can add rich content blocks after webhook submission\n- Unified evidence system eliminates confusion\n- Diploma page can read from single evidence system\n- Future webhooks automatically support rich media\n\nTesting:\n- Run: node test_spark_webhook.js\n- Verify evidence document created/updated in user_task_evidence_documents\n- Verify text block created in evidence_document_blocks\n- Log into Optio UI and edit task evidence\n- Changes should now save successfully\n\nResolves evidence editing issue reported during Spark integration testing.\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude <noreply@anthropic.com>\nEOF\n)\")"
    ],
    "deny": [],
    "ask": []
  }
}
